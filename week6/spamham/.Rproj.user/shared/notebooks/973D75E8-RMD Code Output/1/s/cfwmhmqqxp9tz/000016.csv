"0","# pooling LLR values from all 5 fold cross validation sets to select the new threshold."
"0","# 5-fold cross validations"
"0","k = 5"
"0","trainwordsize <- length(trainMsgWords)"
"0","partK <- sample(trainwordsize)"
"0","total <- k * floor(trainwordsize/k)"
"0","partK <- matrix(partK[1:total], ncol = k)"
"0","testFoldLLR = NULL"
"0","for (i in 1:k) {"
"0","  foldIdx <- partK[ , i]"
"0","  traintableFold <- computeFreqs(trainMsgWords[-foldIdx], trainIsSpam[-foldIdx])"
"0","  testFoldLLR <- c(testFoldLLR, sapply(trainMsgWords[foldIdx], computeMsgLLR, traintableFold))}"
"0","testFoldSpam = NULL"
"0","for (i in 1:k) {"
"0","  foldIdx <- partK[ , i]"
"0","  testFoldSpam <- c(testFoldSpam, trainIsSpam[foldIdx])}"
"0","xFoldI <- typeIErrorRates(testFoldLLR, testFoldSpam)"
"0","xFoldII <- typeIIErrorRates(testFoldLLR, testFoldSpam)"
"0","tauFoldI <- round(min(xFoldI$values[xFoldI$error <= 0.01]))"
"0","tFold2 <- xFoldII$error[ xFoldII$values < tauFoldI ]"
"0","str(testFoldLLR)"
"1"," num [1:6230] "
"1","-99.85 -161.7 71.23 -9.42 -98.08"
"1"," ..."
"1","
"
"0","tauFoldI"
"1","[1]"
"1"," -35"
"1","
"
"0","#Create box plot of LLR for test messages"
"0","spamFoldLab = c(""Ham Messages"", ""Spam Messages"")[1 + testFoldSpam]"
"0","boxplot(testFoldLLR ~ spamFoldLab, ylab = ""Log Likelihood Ratio"","
"0","        main = ""Figure 1: Log Likelihood Ratio for Spam and Ham Test Messages"","
"0","        ylim=c(-500, 500),"
"0","        notch=TRUE,"
"0","        col=(c(""darkgreen"",""gold"")))"
